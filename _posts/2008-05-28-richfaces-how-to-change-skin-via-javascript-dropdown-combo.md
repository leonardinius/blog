---
layout: post
title: Richfaces. How-to change skin via javascript. Dropdown combo.
date: 2008-05-28
comments: false
permalink: 2008/05/richfaces-how-to-cahnge-skin-dropdown.html
tags: [java, jsf, javascript]
---

As we all know - JBoss has acquired wonderful Exadel solutions and we are looking onto JBoss Tools and Richfaces. I am trying to build working application from the scratch using Seam/JSF/Richfaces/Facelets. At the moment I am concentrating onto standard Look-n-Feels and standard skins (with some minor adjustments). So, the task I wiled to solve was - to provide myself the ability to switch between RichFaces skins in the runtime.<br /><br /><a href="http://livedemo.exadel.com/richfaces-demo/index.jsp">RichFaces Live Demo</a> illustrates this in <a href="http://livedemo.exadel.com/richfaces-demo/richfaces/actionparam.jsf">ActionParam Demo</a>. This solution didn't suit me, because amongst switching I had following requirements as well:<br /><ul><li>Switch using DropDown combobox.</li><li>User just should be able to select Skin by name and see the result, it's all. It 1-step procedure, 1-time click. It's not like that: user selects Skin, After that it presses some magic <span style="font-style: italic;">"Apply Skin"</span> button. Things just don't work like that.</li><li>A possibility to set-up default skin is <span style="font-weight: bold;">MUST-HAVE</span> requirement.</li></ul><span style="font-weight: bold;">Last, but not least:</span> It was completely unclear to me how to set-up my environment to make my application to use code snippets proposed (there the value of the "#{skinBean.skin}" comes to etc). So, I had to download Live Demo sources and dig into source code to grep all the <span style="font-style: italic;">skinBean</span> references I could find.<br /><br />So, in conclusion:<br /><ol><li>I didn't like the <a href="http://www.jboss.org/file-access/default/members/jbossrichfaces/freezone/docs/devguide/en/html_single/index.html#suggestionbox">rich:sugessionbo</a>x, because I wanted to have the thing simple and I didn't like the idea of rendering some table-like structures just to display skin name.<br /></li><li><a href="http://www.jboss.org/file-access/default/members/jbossrichfaces/freezone/docs/devguide/en/html_single/index.html#comboBox">rich:combobox</a> provides only the way to define <f:selectitem>elements. So, what about actioning, refreshing etc. what the functionality is all bout. Only onclick="javascript: code()" will suit my needs.</f:selectitem></li></ol>After a little investigation and wrapping my head around JSF/Richfaces I decided to go with the Seam remoting for "javascript: code()" and to use <a href="http://exadel.com/tutorial/jsf/jsftags-guide.html#selectone"><h:selectonemenu></h:selectonemenu></a>just to provide the combo with the standard Look-n-Feel.<br /><h2>Step-by-Step solution</h2>To make Richfaces use custom skin you could insert the following lines into your web.xml file:

<blockquote><pre><code>&lt;context-param&gt;<br />&lt;param-name&gt;org.richfaces.SKIN&lt;/param-name&gt;<br />&lt;param-value&gt;#{skinBean.skin}&lt;/param-value&gt;<br />&lt;/context-param&gt;</code></pre></blockquote><br />What does what mean? It means You have a component named skinBean binded somewhere in the context, which provides you a field <span style="font-style: italic;">skin</span> - the current skin name.<br /><br />I suggest skin to be session-scoped component, since it is that the end-user is waiting for.<br />Here is the code for the skinBean component himself:

<blockquote><pre><code class="java"> <br />@Name("skinBean")<br />@Scope(ScopeType.SESSION)<br />public class SkinBean implements SkinSelector, Serializable {<br />  private static final long serialVersionUID = 7477768262527797286L;<br /><br />  @Logger<br />  Log log;<br />  private String skin;<br /><br />  @Create<br />  public void create() {<br />    log.info("Created");<br />  }<br /><br />  @WebRemote<br />  public String getSkin() {<br />    return skin;<br />  }<br /><br />  @Remove<br />  @Destroy<br />  public void remove() {<br />    log.info("Removed");<br />  }<br /><br />  @WebRemote<br />  public void setSkin(String skinName) {<br />    log.info("Setting skin #0", skinName);<br />    this.skin = skinName;<br />  }<br />}<br /></code></pre></blockquote><br />Comments:

<ul><li>SkinBean implements <span style="font-style: italic;">business  </span>interface SkinSelector, which is @Local interface and (<span style="font-weight: bold;">SHOULD</span>) contain @WebRemote annotation for remoting, but.. InterfaceGenerator class doesn't understand <span style="font-style: italic;">business </span>Beans if they are not <span style="font-style: italic;">session beans</span> (@Stateless or @Stateful). In my case I couldn't make it stateless and for some reason I couldn't make it @Statefull (It failed during startup). So, InterfaceGeneratorrecognizes the component as the JAVA_BEAN. //SkinSelector just contains get/setSkin method declaration.<br /></li><li>You can see thereis no default value present in the code. That to do and what way to go? I decided to provide the default value in the components.xnl - just to allow to change default without recompiling. See the snippet:</li></ul><blockquote><pre><code class="xml"> <br />&lt;component name="skinBean"&gt;<br />&lt;property name="skin"&gt;japanCherry&lt;/property&gt;<br />&lt;/component&gt;<br /></code></pre></blockquote><span style="font-size:130%;"><br />So.. All the things are done. The UI is the last item in the list.</span>

<blockquote><pre><code class="html"> <br />&lt;s:remote include="skinBean" /&gt;<br />&lt;script type='text/javascript'&gt;<br />//&lt;![CDATA[<br />function setSkinValue(skinName){<br />Seam.Component.getInstance('skinBean').setSkin(skinName, function(){<br />Seam.Remoting.log('reloading window');<br />window.location.reload(false);<br />});<br />}<br />//]]&gt;<br />&lt;/script&gt;<br />&lt;h:selectOneMenu id="skinSelector" value="#{skinBean.skin}"<br />onchange="javascript: setSkinValue(this.value);"&gt;<br />&lt;f:selectItem itemValue="DEFAULT" itemLabel="Default" /&gt;<br />&lt;f:selectItem itemValue="plain" itemLabel="Plain" /&gt;<br />&lt;f:selectItem itemValue="blueSky" itemLabel="Blue Sky" /&gt;<br />&lt;f:selectItem itemValue="classic" itemLabel="Classic" /&gt;<br />&lt;f:selectItem itemValue="deepMarine" itemLabel="Deep Marine" /&gt;<br />&lt;f:selectItem itemValue="emeraldTown" itemLabel="Emerald Town" /&gt;<br />&lt;f:selectItem itemValue="japanCherry" itemLabel="Japan Cherry" /&gt;<br />&lt;f:selectItem itemValue="ruby" itemLabel="Ruby" /&gt;<br />&lt;f:selectItem itemValue="wine" itemLabel="Wine" /&gt;<br />&lt;/h:selectOneMenu&gt;<br /></code></pre></blockquote><br /><br />As You can see - All i do is passing value to the component and initiate graceful window refresh.<br /><br /><span style="font-weight: bold;">Vuala, work is done</span>. All is working greatly.
